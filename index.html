<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bombkeeper - 精品在线游戏平台</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            overflow-x: hidden;
        }

        /* 导航栏 */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding: 1rem 0;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .nav-container {
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-left-group {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-item {
            position: relative;
        }

        .nav-link {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .nav-link:hover {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        /* 语言切换按钮 */
        .language-switcher {
            position: relative;
        }

        .language-btn {
            background: transparent;
            color: #333;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .language-btn:hover {
            background: rgba(128, 128, 128, 0.2);
            transform: translateY(-1px);
            box-shadow: none;
        }

        .language-btn .arrow {
            color: #000;
            font-size: 0.8rem;
        }

        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            min-width: 120px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1001;
            margin-top: 0.5rem;
        }

        .language-dropdown.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .language-option {
            padding: 0.8rem 1rem;
            cursor: pointer;
            transition: background 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #333;
            font-size: 0.9rem;
        }

        .language-option:hover {
            background: #f5f5f5;
        }

        .language-option:first-child {
            border-radius: 10px 10px 0 0;
        }

        .language-option:last-child {
            border-radius: 0 0 10px 10px;
        }

        .language-option.active {
            background: rgba(128, 128, 128, 0.3);
            color: #333;
        }

        .language-option.active:hover {
            background: rgba(128, 128, 128, 0.4);
        }

        /* 主内容区域 */
        .main-content {
            margin-top: 80px; /* Navbar height */
            /* min-height: calc(100vh - 80px); */ /* REMOVED: Allow content to dictate height and enable scrolling */
            display: flex;
            gap: 2rem; /* Space between sidebar and content area */
            padding: 2rem;
            /* max-width: 1400px; Overall max width - REMOVED */
            /* margin-left: auto; REMOVED */
            /* margin-right: auto; REMOVED */
        }

        /* 欢迎区域 */
        .hero-section {
            text-align: center;
            padding: 4rem 2rem;
            color: white;
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: fadeInUp 1s ease-out;
        }

        .hero-subtitle {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            opacity: 0.9;
            animation: fadeInUp 1s ease-out 0.2s both;
        }

        /* NEW: Sidebar - Game Categories Section */
        .categories-section {
            width: 280px;
            flex-shrink: 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 1.5rem;
            height: fit-content; /* Adjusts to content or make it scrollable if very long */
        }
        
        .categories-section .section-title { /* Re-styling for sidebar */
            text-align: left;
            font-size: 1.8rem;
            color: white;
            margin-bottom: 1.5rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .categories-section .categories-grid { /* Changed from grid to flex column */
            display: flex;
            flex-direction: column;
            gap: 1rem;
            /* Removed grid-template-columns and old margin */
        }

        .categories-section .category-card { /* Styling for cards in sidebar */
            background: rgba(255, 255, 255, 0.1); /* Base background */
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px; /* Slightly smaller radius */
            padding: 1rem; /* Adjusted padding */
            text-align: left; /* Align text left */
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex; /* For icon and text alignment */
            align-items: center;
            gap: 1rem;
        }

        .categories-section .category-card:hover {
            transform: translateX(5px); /* Subtle horizontal shift */
            background: rgba(255, 255, 255, 0.25); /* Brighter hover */
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }
        
        .categories-section .category-card::before { /* Disabling shine for sidebar cards */
            display: none;
        }

        .categories-section .category-icon {
            font-size: 1.8rem; /* Adjusted icon size */
            margin-bottom: 0; /* Reset margin */
            flex-shrink: 0;
        }

        .categories-section .category-title {
            font-size: 1.1rem; /* Adjusted title size */
            font-weight: bold;
            color: white;
            margin-bottom: 0.2rem;
        }

        .categories-section .category-desc {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.8rem;
            line-height: 1.3;
        }

        /* OLD .categories-section styles are effectively replaced or adapted above */
        /* Remove or comment out old .categories-section, .section-title (if global), .categories-grid, .category-card global styles if they conflict */
        /* For example, the old .categories-section styles at lines 193-200 are no longer needed as global */
        /* The old .section-title at lines 202-208 is now specific to .categories-section .section-title or .page-content-area .section-title */
        /* The old .categories-grid at lines 210-214 is now specific to .categories-section .categories-grid */
        /* The old .category-card at lines 216-248 is now specific to .categories-section .category-card */
        
        /* NEW: Page Content Area (right of sidebar) */
        .page-content-area {
            flex-grow: 1; /* Takes remaining space */
            display: flex;
            flex-direction: column;
            min-width: 0; /* Prevents overflow issues with flex children */
        }
        
        /* Ensure hero section takes full width of its new container */
        #hero-content-area { /* Formerly .hero-section, ID added for JS */
             width: 100%;
        }

        /* 游戏内容区域 */
        .game-content { /* This is #game-display-area */
            display: none; /* Hidden by default, shown by JS */
            padding: 0; /* Padding will be handled by its children or specific content */
            /* max-width: 1200px; Remove - now constrained by .page-content-area */
            /* margin: 0 auto; Remove */
            width: 100%; /* Takes full width of .page-content-area */
        }

        .game-content.active {
            display: block;
        }

        .content-header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .content-title {
            color: white;
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .back-button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
        }

        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        /* 游戏iframe容器 */
        .game-iframe-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden; /* 防止内容溢出 */
        }

        .game-iframe {
            width: 100%;
            height: 600px;
            border: none;
            border-radius: 10px;
            background: #000; /* 改为黑色背景，减少白边视觉效果 */
            display: block; /* 消除内联元素间隙 */
        }

        /* 特定游戏的样式调整 */
        .boxing-game-container {
            background: #000;
            margin: 0 auto;
            padding: 0;
            max-width: 960px;
            height: 630px;
            overflow: hidden;
        }
        
        .boxing-game-frame {
            width: 100%;
            height: 100%;
            border: none;
            margin: 0;
            padding: 0;
        }

        /* 塔防游戏样式 */
        .td-game-container {
            background: #000;
            margin: 0 auto;
            padding: 0;
            max-width: 960px;
            height: 600px;
            overflow: hidden;
        }
        
        .td-game-frame {
            width: 100%;
            height: 100%;
            border: none;
            margin: 0;
            padding: 0;
        }

        /* 扫雷游戏样式 */
        .minesweeper-game-container {
            background: #f0f0f0;
            margin: 0 auto;
            padding: 0;
            max-width: 800px;
            height: 600px;
            overflow: hidden;
            border-radius: 10px;
        }
        
        .minesweeper-game-frame {
            width: 100%;
            height: 100%;
            border: none;
            margin: 0;
            padding: 0;
        }

        /* 游戏列表 */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .game-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }

        .game-card h3 {
            color: white;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .game-card p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }
            
            .nav-right {
                gap: 1rem;
            }

            /* Responsive adjustments for main content and sidebar */
            .main-content {
                flex-direction: column; /* Stack sidebar and content */
                align-items: stretch; /* Stretch items to full width */
                padding: 1rem; /* Adjust padding */
            }

            .categories-section {
                width: 100%; /* Sidebar takes full width */
                margin-bottom: 1.5rem; /* Space below sidebar when stacked */
            }

            /* Optional: adjust category card layout in sidebar for small screens */
            .categories-section .category-card {
                /* flex-direction: column; */ /* Uncomment to stack icon/text vertically */
                /* align-items: flex-start; */
            }
            
            .page-content-area {
                width: 100%;
            }
            
            .hero-title {
                font-size: 2.5rem;
            }
            
            .game-iframe {
                height: 400px;
            }
        }

        /* 动画 */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeInUp 0.8s ease-out;
        }

        /* 加载动画 */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-left-group">
                <div class="logo" data-lang-key="logo">🎮 bombkeeper</div>
                <a href="#" class="nav-link" onclick="showHome()" data-lang-key="nav-home">首页</a>
            </div>
            <div class="nav-right">
                <div class="language-switcher">
                    <button class="language-btn" onclick="toggleLanguageDropdown()">
                        <span id="current-language">中文</span>
                        <span class="arrow">▼</span>
                    </button>
                    <div class="language-dropdown" id="language-dropdown">
                        <div class="language-option active" onclick="changeLanguage('zh-CN')">
                            <span>🇨🇳</span>
                            <span>中文</span>
                        </div>
                        <div class="language-option" onclick="changeLanguage('en-US')">
                            <span>🇺🇸</span>
                            <span>English</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- 主内容 -->
    <main class="main-content">
        <!-- 左侧游戏分类 (原 categories-section) -->
        <aside class="categories-section">
            <h2 class="section-title" data-lang-key="categories-title">🎯 游戏分类</h2>
            <div class="categories-grid">
                <div class="category-card" onclick="showCategory('action')">
                    <div class="category-icon">⚔️</div>
                    <div>
                        <h3 class="category-title" data-lang-key="action-title">动作游戏</h3>
                        <p class="category-desc" data-lang-key="action-desc">刺激的战斗与冒险等你来挑战</p>
                    </div>
                </div>
                <div class="category-card" onclick="showCategory('puzzle')">
                    <div class="category-icon">🧩</div>
                    <div>
                        <h3 class="category-title" data-lang-key="puzzle-title">益智游戏</h3>
                        <p class="category-desc" data-lang-key="puzzle-desc">锻炼大脑，挑战智力极限</p>
                    </div>
                </div>
                <div class="category-card" onclick="showCategory('strategy')">
                    <div class="category-icon">🏰</div>
                    <div>
                        <h3 class="category-title" data-lang-key="strategy-title">策略游戏</h3>
                        <p class="category-desc" data-lang-key="strategy-desc">运筹帷幄，决胜千里</p>
                    </div>
                </div>
                <div class="category-card" onclick="showCategory('casual')">
                    <div class="category-icon">🎈</div>
                    <div>
                        <h3 class="category-title" data-lang-key="casual-title">休闲游戏</h3>
                        <p class="category-desc" data-lang-key="casual-desc">轻松娱乐，放松身心</p>
                    </div>
                </div>
                <div class="category-card" onclick="showCategory('rpg')">
                    <div class="category-icon">🗡️</div>
                    <div>
                        <h3 class="category-title" data-lang-key="rpg-title">角色扮演</h3>
                        <p class="category-desc" data-lang-key="rpg-desc">沉浸式体验，成为传奇英雄</p>
                    </div>
                </div>
                <div class="category-card" onclick="showCategory('adventure')">
                    <div class="category-icon">🗺️</div>
                    <div>
                        <h3 class="category-title" data-lang-key="adventure-title">探险游戏</h3>
                        <p class="category-desc" data-lang-key="adventure-desc">踏上未知的旅程，探索奇妙的世界</p>
                    </div>
                </div>
                <div class="category-card" onclick="showCategory('racing')">
                    <div class="category-icon">🏎️</div>
                    <div>
                        <h3 class="category-title" data-lang-key="racing-title">竞速游戏</h3>
                        <p class="category-desc" data-lang-key="racing-desc">速度与激情的完美结合</p>
                    </div>
                </div>
            </div>
        </aside>

        <!-- 右侧主内容区域 -->
        <div class="page-content-area">
            <!-- 欢迎区域 -->
            <section id="hero-content-area" class="hero-section">
                <h1 class="hero-title" data-lang-key="hero-title">欢迎来到bombkeeper</h1>
                <p class="hero-subtitle" data-lang-key="hero-subtitle">探索精彩纷呈的在线游戏世界，享受无限乐趣！</p>
            </section>

            <!-- 游戏内容页面 -->
            <div id="game-display-area" class="game-content"> <!-- ID changed from game-content to game-display-area -->
                <button class="back-button" onclick="showHome()" data-lang-key="back-button">← 返回首页</button>
                <div class="content-header">
                    <h2 class="content-title" id="category-title">游戏分类</h2>
                    <p id="category-description" data-lang-key="select-game">选择您喜欢的游戏开始游玩</p>
                </div>
                
                <!-- 游戏列表 -->
                <div class="games-grid" id="games-list">
                    <!-- 游戏卡片将通过JavaScript动态生成 -->
                </div>
                
                <!-- iframe容器 -->
                <div class="game-iframe-container" id="iframe-container" style="display: none;">
                    <iframe id="game-iframe" class="game-iframe" src="" scrolling="no"></iframe>
                </div>
            </div>
        </div>
    </main>

    <script>
        // 多语言文本数据
        const translations = {
            'zh-CN': {
                'logo': '🎮 bombkeeper',
                'nav-home': '首页',
                'nav-action': '动作游戏',
                'nav-puzzle': '益智游戏',
                'nav-strategy': '策略游戏',
                'nav-casual': '休闲游戏',
                'nav-rpg': '角色扮演',
                'nav-adventure': '探险游戏',
                'hero-title': '欢迎来到bombkeeper',
                'hero-subtitle': '探索精彩纷呈的在线游戏世界，享受无限乐趣！',
                'categories-title': '🎯 游戏分类',
                'action-title': '动作游戏',
                'action-desc': '刺激的战斗与冒险等你来挑战',
                'puzzle-title': '益智游戏',
                'puzzle-desc': '锻炼大脑，挑战智力极限',
                'strategy-title': '策略游戏',
                'strategy-desc': '运筹帷幄，决胜千里',
                'casual-title': '休闲游戏',
                'casual-desc': '轻松娱乐，放松身心',
                'rpg-title': '角色扮演',
                'rpg-desc': '沉浸式体验，成为传奇英雄',
                'racing-title': '竞速游戏',
                'racing-desc': '速度与激情的完美结合',
                'adventure-title': '探险游戏',
                'adventure-desc': '踏上未知的旅程，探索奇妙的世界',
                'back-button': '← 返回首页',
                'select-game': '选择您喜欢的游戏开始游玩'
            },
            'en-US': {
                'logo': '🎮 bombkeeper',
                'nav-home': 'Home',
                'nav-action': 'Action',
                'nav-puzzle': 'Puzzle',
                'nav-strategy': 'Strategy',
                'nav-casual': 'Casual',
                'nav-rpg': 'RPG',
                'nav-adventure': 'Adventure',
                'hero-title': 'Welcome to bombkeeper',
                'hero-subtitle': 'Explore the wonderful world of online games and enjoy unlimited fun!',
                'categories-title': '🎯 Game Categories',
                'action-title': 'Action Games',
                'action-desc': 'Exciting battles and adventures await your challenge',
                'puzzle-title': 'Puzzle Games',
                'puzzle-desc': 'Exercise your brain and challenge your intelligence',
                'strategy-title': 'Strategy Games',
                'strategy-desc': 'Plan strategies and win battles',
                'casual-title': 'Casual Games',
                'casual-desc': 'Relax and enjoy entertainment',
                'rpg-title': 'Role Playing',
                'rpg-desc': 'Immersive experience, become a legendary hero',
                'racing-title': 'Racing Games',
                'racing-desc': 'Perfect combination of speed and passion',
                'adventure-title': 'Adventure Games',
                'adventure-desc': 'Embark on unknown journeys and explore fantastic worlds',
                'back-button': '← Back to Home',
                'select-game': 'Choose your favorite game to start playing'
            }
        };

        // 当前语言
        let currentLanguage = 'zh-CN';

        // 游戏数据
        const gameData = {
            action: {
                title: {
                    'zh-CN': "⚔️ 动作游戏",
                    'en-US': "⚔️ Action Games"
                },
                description: {
                    'zh-CN': "体验刺激的战斗与冒险",
                    'en-US': "Experience exciting battles and adventures"
                },
                games: [
                    { 
                        name: { 'zh-CN': "Dead Zed", 'en-US': "Dead Zed" }, 
                        desc: { 'zh-CN': "刺激的动作冒险", 'en-US': "Exciting action adventure" }, 
                        url: "https://storage.y8.com/y8-studio/html5/zoki/a646a84dc850/?key=y8&value=default" 
                    },
                    { 
                        name: { 'zh-CN': "Punch Boxing Championship", 'en-US': "Punch Boxing Championship" }, 
                        desc: { 'zh-CN': "刺激的拳击冠军赛游戏", 'en-US': "Exciting boxing championship game" }, 
                        url: "https://storage.y8.com/y8-studio/unity/akeemywka/punch_boxing_championship/?key=y8&value=default" 
                    }
                ]
            },
            puzzle: {
                title: {
                    'zh-CN': "🧩 益智游戏",
                    'en-US': "🧩 Puzzle Games"
                },
                description: {
                    'zh-CN': "锻炼大脑，挑战智力",
                    'en-US': "Exercise your brain and challenge your intelligence"
                },
                games: [
                    { 
                        name: { 'zh-CN': "扫雷", 'en-US': "Minesweeper" }, 
                        desc: { 'zh-CN': "经典的逻辑推理游戏", 'en-US': "Classic logic puzzle game" }, 
                        url: "https://ohminesweeper.online/",
                        specialStyle: "minesweeper-game" // 添加特殊样式标记
                    }
                ]
            },
            strategy: { // Ensuring strategy category exists, even if empty for now
                title: {
                    'zh-CN': "🏰 策略游戏",
                    'en-US': "🏰 Strategy Games"
                },
                description: {
                    'zh-CN': "运筹帷幄，制定战略",
                    'en-US': "Plan strategies and make tactical decisions"
                },
                games: [
                    { 
                        name: { 'zh-CN': "Tower Defense: Monster Mash", 'en-US': "Tower Defense: Monster Mash" }, 
                        desc: { 'zh-CN': "经典塔防游戏，抵御怪物入侵", 'en-US': "Classic tower defense game, defend against monster invasion" }, 
                        url: "https://www.spiele-umsonst.de/azad/downloads/unitywebgl/tdmonstermash/?key=y8&value=default",
                        specialStyle: "td-game" // 添加特殊样式标记
                    }
                ]
            },
            casual: { // Adding Pac-Man to casual games
                title: {
                    'zh-CN': "🎈 休闲游戏",
                    'en-US': "🎈 Casual Games"
                },
                description: {
                    'zh-CN': "轻松娱乐，放松心情",
                    'en-US': "Relax and enjoy entertainment"
                },
                games: [
                    { 
                        name: { 'zh-CN': "吃豆人", 'en-US': "Pac-Man" }, 
                        desc: { 'zh-CN': "经典的街机游戏，躲避幽灵，吃掉所有豆子。", 'en-US': "Classic arcade game, avoid ghosts and eat all the dots." }, 
                        url: "https://passer-by.com/pacman/" 
                    }
                ]
            },
            rpg: { // Ensuring rpg category exists
                title: {
                    'zh-CN': "🗡️ 角色扮演",
                    'en-US': "🗡️ Role Playing"
                },
                description: {
                    'zh-CN': "扮演角色，体验冒险",
                    'en-US': "Play roles and experience adventures"
                },
                games: []
            },
            racing: { // Ensuring racing category exists
                title: {
                    'zh-CN': "🏎️ 竞速游戏",
                    'en-US': "🏎️ Racing Games"
                },
                description: {
                    'zh-CN': "速度与激情的体验",
                    'en-US': "Experience speed and passion"
                },
                games: []
            },
            adventure: { // ADDED adventure category
                title: {
                    'zh-CN': "🗺️ 探险游戏",
                    'en-US': "🗺️ Adventure Games"
                },
                description: {
                    'zh-CN': "踏上未知的旅程，探索奇妙的世界",
                    'en-US': "Embark on unknown journeys and explore fantastic worlds"
                },
                games: []
            }
        };

        // 语言切换功能
        function toggleLanguageDropdown() {
            const dropdown = document.getElementById('language-dropdown');
            dropdown.classList.toggle('show');
        }

        // 切换语言
        function changeLanguage(language) {
            currentLanguage = language;
            
            // 更新当前语言显示
            const currentLangSpan = document.getElementById('current-language');
            currentLangSpan.textContent = language === 'zh-CN' ? '中文' : 'English';
            
            // 更新语言选项的激活状态
            const options = document.querySelectorAll('.language-option');
            options.forEach(option => {
                option.classList.remove('active');
                if ((language === 'zh-CN' && option.textContent.includes('中文')) ||
                    (language === 'en-US' && option.textContent.includes('English'))) {
                    option.classList.add('active');
                }
            });
            
            // 更新页面文本
            updatePageText();
            
            // 隐藏下拉菜单
            document.getElementById('language-dropdown').classList.remove('show');
            
            // 保存语言选择到本地存储
            localStorage.setItem('preferred-language', language);
        }

        // 更新页面文本
        function updatePageText() {
            const elements = document.querySelectorAll('[data-lang-key]');
            elements.forEach(element => {
                const key = element.getAttribute('data-lang-key');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
        }

        // 显示首页
        function showHome() {
            document.getElementById('hero-content-area').style.display = 'block';
            const gameDisplayArea = document.getElementById('game-display-area');
            if (gameDisplayArea) gameDisplayArea.classList.remove('active');
            
            const iframeContainer = document.getElementById('iframe-container');
            if (iframeContainer) iframeContainer.style.display = 'none';

            const gamesList = document.getElementById('games-list');
            if (gamesList) gamesList.style.display = 'grid'; 
            
            // Reset content-header state for when gameDisplayArea becomes active again
            if (gameDisplayArea) {
                const contentHeader = gameDisplayArea.querySelector('.content-header');
                if (contentHeader) {
                    contentHeader.style.display = 'block'; // Default display
                }
                const categoryDescElement = document.getElementById('category-description');
                if (categoryDescElement) {
                    categoryDescElement.style.display = 'block'; // Default display
                }
            }
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 显示游戏分类
        function showCategory(category) {
            const data = gameData[category];
            if (!data) return;

            document.getElementById('hero-content-area').style.display = 'none';
            const gameDisplayArea = document.getElementById('game-display-area');
            if (gameDisplayArea) {
                gameDisplayArea.classList.add('active');
            }
            
            const contentHeader = gameDisplayArea.querySelector('.content-header');
            if (contentHeader) {
                contentHeader.style.display = 'none'; // Hide category title/desc when showing game list
            }

            const iframeContainer = document.getElementById('iframe-container');
            if (iframeContainer) iframeContainer.style.display = 'none';
            
            const gamesList = document.getElementById('games-list');
            if (gamesList) {
                gamesList.style.display = 'grid'; // 确保游戏列表容器可见
                gamesList.innerHTML = ''; // 清空旧游戏
                data.games.forEach(game => {
                    const gameCard = document.createElement('div');
                    gameCard.className = 'game-card fade-in';
                    gameCard.innerHTML = `
                        <h3>${game.name[currentLanguage]}</h3>
                        <p>${game.desc[currentLanguage]}</p>
                    `;
                    gameCard.onclick = () => loadGame(game.url, game.name[currentLanguage], false, game.specialStyle);
                    gamesList.appendChild(gameCard);
                });
            }
            
            window.scrollTo({ top: 80, behavior: 'smooth' }); // 滚动到导航栏下方
        }

        // 加载游戏
        function loadGame(url, name, isExternal, specialStyle) {
            if (isExternal) {
                // 如果是外部链接，在新标签页中打开
                window.open(url, '_blank');
                return; // 不继续执行下面的代码
            }
            
            const iframe = document.getElementById('game-iframe');
            const container = document.getElementById('iframe-container');
            const gamesList = document.getElementById('games-list');
            const gameDisplayArea = document.getElementById('game-display-area');
            
            if (gameDisplayArea && !gameDisplayArea.classList.contains('active')) {
                document.getElementById('hero-content-area').style.display = 'none';
                gameDisplayArea.classList.add('active');
            }

            const contentHeader = gameDisplayArea.querySelector('.content-header');
            if (contentHeader) {
                contentHeader.style.display = 'block'; // Show the header for the game title
            }

            const categoryDescElement = document.getElementById('category-description');
            if (categoryDescElement) {
                categoryDescElement.style.display = 'none'; // Hide the category description part
            }

            if (gamesList) gamesList.innerHTML = ''; // Clear the games list content
            if (container) container.style.display = 'block'; 
            
            // 根据游戏类型应用特殊样式
            if (specialStyle === 'td-game') {
                // 塔防游戏样式
                container.className = 'game-iframe-container td-game-container';
                if (iframe) {
                    iframe.className = 'td-game-frame';
                    iframe.scrolling = 'no';
                    iframe.src = '';
                }
            } else if (specialStyle === 'minesweeper-game') {
                // 扫雷游戏样式
                container.className = 'game-iframe-container minesweeper-game-container';
                if (iframe) {
                    iframe.className = 'minesweeper-game-frame';
                    iframe.scrolling = 'no';
                    iframe.src = '';
                }
            } else if (name.includes("Boxing")) {
                // 拳击游戏样式
                container.className = 'game-iframe-container boxing-game-container';
                if (iframe) {
                    iframe.className = 'boxing-game-frame';
                    iframe.scrolling = 'no';
                    iframe.src = '';
                }
            } else {
                // 默认样式
                container.className = 'game-iframe-container';
                if (iframe) {
                    iframe.className = 'game-iframe';
                    iframe.scrolling = 'no';
                    iframe.src = '';
                }
            }
            
            const titleElement = document.getElementById('category-title'); 
            if (titleElement) {
                titleElement.innerHTML = `🎮 ${name} <span class="loading"></span>`;
            }
            
            setTimeout(() => {
                if (iframe) iframe.src = url;
                if (titleElement) titleElement.textContent = `🎮 ${name}`;
            }, 500);
            
            setTimeout(() => {
                if (container) {
                    container.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }, 600);
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 从本地存储恢复语言设置
            const savedLanguage = localStorage.getItem('preferred-language');
            if (savedLanguage && translations[savedLanguage]) {
                changeLanguage(savedLanguage);
            }
            
            showHome();
            
            // 添加滚动效果
            window.addEventListener('scroll', function() {
                const navbar = document.querySelector('.navbar');
                if (window.scrollY > 50) {
                    navbar.style.background = 'rgba(255, 255, 255, 0.98)';
                    navbar.style.boxShadow = '0 4px 20px rgba(0,0,0,0.1)';
                } else {
                    navbar.style.background = 'rgba(255, 255, 255, 0.95)';
                    navbar.style.boxShadow = 'none';
                }
            });
            
            // 点击外部关闭语言下拉菜单
            document.addEventListener('click', function(e) {
                const languageSwitcher = document.querySelector('.language-switcher');
                if (!languageSwitcher.contains(e.target)) {
                    document.getElementById('language-dropdown').classList.remove('show');
                }
            });
        });

        // 添加键盘快捷键
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                showHome();
                document.getElementById('language-dropdown').classList.remove('show');
            }
        });
    </script>
</body>
</html>